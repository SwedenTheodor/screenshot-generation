/*! Angular Screenshot - v0.1.0 - http://weihanchen.github.io/angular-screenshot - (c) 2017 weihanchen - MIT */
!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}var o=n(4),s=r(o),a=n(3),i=function(){var e=function(e,t,n){var r={gray:"#898b89",lightGray:"#e6e3e3"},o={top:1,second:0},i=this,c=function(e){i.showToolbox=!1,e.stopPropagation()},u=function(e){console.log("download"),e.stopPropagation()},f=function(){var e=0;return s.element("body *").each(function(){var t=s.element(this).css("zIndex");t>e&&(e=t)}),e},l=function(){var e=f();o.second=e+1,o.top=o.second+1},d=function(t,r){i.rect=r;var s='<div><button ng-click="screenshotCtrl.download()">Download</button></div>',a=n(s)(e);document.body.appendChild(a[0]);var c=t.offsetTop+r.startY+r.h+5,u=t.offsetLeft+r.startX;a.offset({top:c+"px",left:u+"px"}),a.css("zIndex",o.top),a.css({position:"absolute"})},p=function(){i.interactiveCanvas&&i.interactiveCanvas.remove(),i.toolboxElement&&i.toolboxElement.remove()},v=function(){var e=i.parent?s.element(i.parent):t,n=e[0],c=n.offsetWidth,u=n.offsetHeight,f=n.offsetLeft,p=n.offsetTop;l(),a.domprocess.createCanvas(c,u).then(function(e){return a.domprocess.setCanvasStyle(e,f,p,r.gray,o.second)}).then(a.domprocess.appendToBody).then(function(e){return a.domprocess.listenInteractiveCanvas(e,r.lightGray,d)}).then(function(e){return i.interactiveCanvas=e})};i.cancel=c,i.download=u,i.interactiveCanvas,i.toolboxElement,e.$watch(function(){return i.isOpen},function(e){e===!0?v():e===!1&&p()})};return{restrict:"AE",scope:{template:"=?",templateScope:"=?",parent:"=",isOpen:"="},controller:["$scope","$element","$compile",e],controllerAs:"screenshotCtrl",bindToController:!0}};s.module("angular-screenshot",[]).directive("screenshot",i)},function(e,t){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var r="http://www.w3.org/2000/svg",o=function(e){return a(e).then(function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e})},s=function(e){return new Promise(function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e})},a=function(){var e=document.styleSheets;if(!e)return Promise.resolve("");var t=u(e),r=t.reduce(function(e,t){var r=u(t.rules||t.cssRules);return e.push.apply(e,n(r.map(function(e){return e.cssText}))),e},[]).filter(function(e){return e}).join("");return Promise.resolve(r)},i=function(e){return Promise.resolve(e).then(function(e){return e.setAttribute("xmlns",e.namespaceURI),(new XMLSerializer).serializeToString(e)}).then(function(e){return"<foreignObject x='0' y='0' width='100%' height='100%'>"+e+"</foreignObject>"}).then(function(e){return"<svg xmlns='"+r+"' width='100%' height='100%'>"+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})},c=function(e){var t=e.cloneNode(!0),n=e.offsetWidth,r=e.offsetHeight;return Promise.resolve(t).then(o).then(i).then(s).then(function(e){var t=document.createElement("canvas");return t.width=n,t.height=r,t.getContext("2d").drawImage(e,0,0),t})},u=function(e){return Object.keys(e).map(function(t){return e[t]})},f={getCanvas:c};t.default=f},function(e,t){"use strict";"use strice";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return document.body.appendChild(e),e},r=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,Promise.resolve(n)},o=function(e,t,n){var r=e.getContext("2d"),o={startX:0,startY:0,w:0,h:0},s=!1,a=function(){r.fillStyle=t,r.fillRect(o.startX,o.startY,o.w,o.h)},i=function(t){o.startX=t.pageX-e.offsetLeft,o.startY=t.pageY-e.offsetTop,o.w=0,o.h=0,s=!0},c=function(t){s&&(o.w=t.pageX-e.offsetLeft-o.startX,o.h=t.pageY-e.offsetTop-o.startY,r.clearRect(0,0,e.width,e.height),a())},u=function(){s=!1,0!=o.w&&0!=o.h&&n(e,o)};return e.addEventListener("mousedown",i,!1),e.addEventListener("mouseup",u,!1),e.addEventListener("mousemove",c,!1),Promise.resolve(e)},s=function(e,t,n,r,o){return e.style.cursor="crosshair",e.style.position="absolute",e.style.left=t+"px",e.style.top=n+"px",e.style.background=r,e.style.zIndex=o,e.style.opacity=.5,e},a={appendToBody:n,createCanvas:r,listenInteractiveCanvas:o,setCanvasStyle:s};t.default=a},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.domprocess=t.domcapture=void 0;var o=n(1),s=r(o),a=n(2),i=r(a);t.domcapture=s.default,t.domprocess=i.default,t.default={domcapture:s.default,domprocess:i.default}},function(e,t){e.exports=angular}]);